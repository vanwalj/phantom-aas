#!/usr/bin/env node
'use strict';

const express = require('express');
const bodyParser = require('body-parser');

const phantom = require('../');

const app = express();

const port = process.env.PORT || 9999;

const handler = () => (req, res, next) => {
  next = next || () => null;
  
  return phantom(req.body.html)
    .then(pdf => res.send('data:application/pdf;base64,' + new Buffer(pdf).toString('base64')))
    .asCallback(next);
};

app
  .use(bodyParser.json())
  .use(handler())
  .listen(port, () => {
    console.log(`Listening on ${ port }`);
  });
